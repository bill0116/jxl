<div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width:800px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="searchModalLabel">
                    代码名称查询
                </h4>
            </div>
            <div class="modal-body" style="overflow:auto;">
                <table class="table table-striped table-bordered bootstrap-datatable datatable dataTable"
                       aria-describedby="DataTables_Table_0_info">
                    <thead>
                    <tr role=" row">
                        <td>
                            客户代码
                        </td>
                        <td>
                            <input type="text" id="buyerKunnr1">
                        </td>
                        <td>
                            客户名称
                            <input type="text" id="buyerName1">
                        </td>
                        <td>
                            <input type="button" onclick="checkBuyerNo(this)" value="查询">
                        </td>
                    </tr>
                    </thead>
                    <tbody id="sureSearch">

                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <input type="reset" value="重置" class="btn btn-sm"
                       style="border:0px solid #fff ">
                <input type="button" value="关闭" class="btn btn-sm" data-dismiss="modal"
                       style="border:0px solid #fff ">
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="searchCountryModal" tabindex="-1" role="dialog" aria-labelledby="searchCountryModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width:800px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="searchCountryModalLabel">
                    国家代码名称查询
                </h4>
            </div>
            <div class="modal-body" style="overflow:auto;">
                <table class="table table-striped table-bordered bootstrap-datatable datatable dataTable"
                       aria-describedby="DataTables_Table_0_info">
                    <thead>
                    <tr role=" row">
                        <td>
                            国家代码
                        </td>
                        <td>
                            <input type="text" id="CountryKunnr">
                        </td>
                        <td>
                            国家名称
                            <input type="text" id="CountryName">
                        </td>
                        <td>
                            <input type="button" id="checkTypeCountry" onclick="checkCountryName(this)" value="查询"
                                   style="width:auto;">
                        </td>
                    </tr>
                    </thead>
                    <tbody id="sureCountrySearch">
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <input type="reset" value="重置" class="btn btn-sm"
                       style="border:0px solid #fff ">
                <input type="button" value="关闭" class="btn btn-sm" data-dismiss="modal"
                       style="border:0px solid #fff ">
            </div>
        </div>
    </div>
</div>
<!--竞争对手-->
<div class="modal fade" id="salesOpponentModal" tabindex="-1" role="dialog" aria-labelledby="searchCountryModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width:800px;">
        <div class="modal-content">
            <input type="button" class="btn btn-info" id="saveSalesOpponent" onclick="saveSalesOpponent()" value="保存" style="width:auto;">
            <div class="modal-body" style="overflow:auto;">
                <table class="Opponent table table-striped table-bordered bootstrap-datatable datatable dataTable">
                 <style>
                     .Opponent td input{
                         width: 98%;
                     }
                 </style>
                    <thead>
                    <tr>
                        <td style="display: none;">
                            ID
                        </td>
                        <td style="display: none;">
                            <input type="text" name="OpponentID"  id="OpponentID" value="">
                        </td>
                        <td>
                            公司名称
                        </td>
                        <td>
                            <input type="text" name="companyName"  id="companyName" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            地址
                        </td>
                        <td>
                            <input type="text" name="address" id="address" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            企业类型
                        </td>
                        <td>
                            <input type="text" name="companyType" id="companyType"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            经营范围
                        </td>
                        <td>
                            <input type="text" name="businessScope" id="businessScope" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            销售区域
                        </td>
                        <td>
                            <input type="text" name="salesScope" id="salesScope" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            产品品牌
                        </td>
                        <td>
                            <input type="text" name="brand" id="brand"   value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            员工人数
                        </td>
                        <td>
                            <input type="text" name="staff" id="staff"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            发展规划
                        </td>
                        <td>
                            <textarea name="plan" id="plan" rows="3" style="width:98%;overflow-y:auto;"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            综合介绍
                        </td>
                        <td>
                            <textarea name="introduce" id="introduce" rows="3" style="width:98%;overflow-y:auto;"></textarea>
                        </td>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>

<!--供应商-->
<div class="modal fade" id="supplierModal" tabindex="-1" role="dialog" aria-labelledby="searchCountryModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width:800px;">
        <div class="modal-content">
            <input type="button" class="btn btn-info" id="saveSupplier" onclick="saveSupplier()" value="保存" style="width:auto;">
            <div class="modal-body" style="overflow:auto;">
                <table class="Supplier table table-striped table-bordered bootstrap-datatable datatable dataTable">
                    <style>
                        .Supplier td input{
                            width: 98%;
                        }
                    </style>
                    <thead>
                    <tr>
                        <td style="display: none;">
                            ID
                        </td>
                        <td style="display: none;">
                            <input type="text" name="SupplierID"  id="SupplierID" value="">
                        </td>
                        <td>
                            公司名称
                        </td>
                        <td>
                            <input type="text" name="supplierName"  id="supplierName" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            公司地址
                        </td>
                        <td>
                            <input type="text" name="supplierAddress" id="supplierAddress" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                         联系电话
                        </td>
                        <td>
                            <input type="text" name="linkPhone" id="linkPhone"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            联系人
                        </td>
                        <td>
                            <input type="text" name="linkman" id="linkman" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            采访时间
                        </td>
                        <td>
                            <input type="text" name="interviewDate" id="interviewDate" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            合作开始时间
                        </td>
                        <td>
                            <input type="text" name="start" id="start"   value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                           主要交易产品
                        </td>
                        <td>
                            <input type="text" name="mainProduct" id="mainProduct"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            信用额度
                        </td>
                        <td>
                            <input type="text" name="limit" id="limit"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            付款方式
                        </td>
                        <td>
                            <input type="text" name="payType" id="payType"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            付款期限
                        </td>
                        <td>
                            <input type="text" name="term" id="term"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            综合介绍
                        </td>
                        <td>
                            <textarea name="evaluate" id="evaluate" rows="3" style="width:98%;overflow-y:auto;"></textarea>
                        </td>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>

<!--客户-->
<div class="modal fade" id="customerModal" tabindex="-1" role="dialog" aria-labelledby="searchCountryModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width:800px;">
        <div class="modal-content">
            <input type="button" class="btn btn-info" id="saveCustomer" onclick="saveCustomer()" value="保存" style="width:auto;">
            <div class="modal-body" style="overflow:auto;">
                <table class="Supplier table table-striped table-bordered bootstrap-datatable datatable dataTable">
                    <style>
                        .Supplier td input{
                            width: 98%;
                        }
                    </style>
                    <thead>
                    <tr>
                        <td style="display: none;">
                            ID
                        </td>
                        <td style="display: none;">
                            <input type="text" name="CustomerID"  id="CustomerID" value="">
                        </td>
                        <td>
                            公司名称
                        </td>
                        <td>
                            <input type="text" name="customerName"  id="customerName" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            公司地址
                        </td>
                        <td>
                            <input type="text" name="customerAddress" id="customerAddress" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            联系电话
                        </td>
                        <td>
                            <input type="text" name="linkPhone1" id="linkPhone1"  value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            联系人
                        </td>
                        <td>
                            <input type="text" name="linkman1" id="linkman1" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            采访时间
                        </td>
                        <td>
                            <input type="text" name="interviewDate1" id="interviewDate1" value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            合作开始时间
                        </td>
                        <td>
                            <input type="text" name="start1" id="start1"   value="">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            主要交易产品
                        </td>
                        <td>
                            <input type="text" name="mainProduct1" id="mainProduct1"  value="">
                        </td>
                    </tr>

                    <tr>
                        <td>
                            综合介绍
                        </td>
                        <td>
                            <textarea name="evaluate1" id="evaluate1" rows="3" style="width:98%;overflow-y:auto;"></textarea>
                        </td>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    /*
     * @ 根据客户代码获得名称，联系人，电话
     * */
    function getBuyerName() {
        //按回车键获取公司的相关信息
        if (event.keyCode == 13) {
            var buyerNo = $.trim($('#buyerNo').val());
            if (buyerNo != '') {
                $.ajax({
                    type: 'post',
                    data: {buyerNo: buyerNo},
                    url: "{:url('Common/getSinosureBuyer')}",
                    dataType: 'json',
                    success: function (data) {
                        if (data.code == 1) {
                            sureCheckBuyerNo(data['data'].buyerno, data['data'].buyerName, data['data'].buyerTel, data['data'].buyerPerson,data['data'].entrustor,data['data'].specicalRequire,data['data'].finishDay);
                        } else {
                            $('#buyerEngName').after("<span style='color:red;'>" + data.msg + "</span>");
                        }
                    },
                    error: function () {
                        alert("系统繁忙中...");
                    }
                });
            } else {
                $('#buyerEngName').val("");
            }
            // 按回车，不让表单提交
            if(event.preventDefault) {
                event.preventDefault();
            }
        }
    }
    /*
     * @ 弹出层查找买家代码及名称
     * */
    function checkBuyerNo() {
        var buyerKunnr = $.trim($('#buyerKunnr1').val());
        var buyerName = $.trim($('#buyerName1').val());
        $.get("{:url('Common/getSinosureBuyer')}",
                {"buyerKunnr": buyerKunnr, "buyerName": buyerName},
                function (data) {
                    if (data.code == 1) {
                        $('#sureSearch').html(data.data);
                    }
                });
    }
    /*
     * @ 确认选择买家代码及名称
     * */
    function sureCheckBuyerNo(buyerKunnur, buyerName,buyerTel,buyerPerson,entrustor,specicalRequire,finishDay) {
        $('#buyerNo').val(buyerKunnur);
        $('#buyerName').val(buyerName);
        $('#buyerTel').val(buyerTel);
        $('#buyerPerson').val(buyerPerson);
        $('#entrustor').val(entrustor);
        $('#specicalRequire').val(specicalRequire);
        $('#finishDay').val(finishDay);
        $('#searchModal').modal("hide");
    }



    /*
     * @ 选择国家类型代码及名称
     * */
    function checkTypeCountry(val) {
        $('#sureCountrySearch').empty();
        $('#checkTypeCountry').attr('onclick', "checkCountryName('" + val + "')");
    }
    /*
     * @ 根据国家代码获得名称
     * */
    function getCountryName(key) {
        if (event.keyCode == 13) {
            if (key == 'buyer') {
                var CountryCode = $.trim($('#buyerCountryCode').val());
            } else {
                var CountryCode = $.trim($('#warrantorCountryCode').val());
            }
            if (CountryCode != '') {
                $.ajax({
                    type: 'post',
                    data: {CountryCode: CountryCode},
                    url: "{:url('Common/getCountryName')}",
                    dataType: 'json',
                    success: function (data) {
                        if (data.code == 1) {
                            sureCheckCountryName(data['data'].CountryCode, data['data'].CountryName, key);
                        }
                    },
                    error: function () {
                        alert("系统繁忙中...");
                    }
                });
            }
            return false;
        }
    }
    /*
     * @ 弹出层查找国家代码及名称
     * */
    function checkCountryName(key) {
        var CountryKunnr = $.trim($('#CountryKunnr').val());
        var CountryName = $.trim($('#CountryName').val());
        $.get("{:url('Common/getCountryName')}",
                {"CountryKunnr": CountryKunnr, "CountryName": CountryName, key: key},
                function (data) {
                    if (data.code == 1) {
                        $('#sureCountrySearch').html(data.data);
                    }
                });
    }
    /*
     * @ 确认选择国家代码及名称
     * */
    function sureCheckCountryName(countryKunnur, countryName, key) {
        if (key == 'buyer') {
            $('#buyerCountryCode').val(countryKunnur);
            $('#buyerCountryName').val(countryName);
        }else if(key == 'warrantor') {
            $('#warrantorCountryCode').val(countryKunnur);
            $('#warrantorCountryName').val(countryName);
        }else if(key == 'opbank'){
            $('#openBankCountryCode').val(countryKunnur);
            $('#openBankCountryName').val(countryName);
        }else if(key == 'exbank'){
            $('#exBankCountryCode').val(countryKunnur);
            $('#exBankCountryName').val(countryName);
        }
        $('#searchCountryModal').modal("hide");
    }

    /*
     * 保存销售竞争对手
     * */
    function saveSalesOpponent(){
        var OpponentID=$("#OpponentID").val();
        var applicationid=$("#applicationid").val();
        var companyName = $.trim($("#companyName").val());
        var address=$.trim($("#address").val());
        var companyType=$.trim($("#companyType").val());
        var businessScope=$.trim($("#businessScope").val());
        var salesScope=$.trim($("#salesScope").val());
        var brand=$.trim($("#brand").val());
        var staff=$.trim($("#staff").val());
        var plan=$.trim($("#plan").val());
        var introduce=$.trim($("#introduce").val());
        if (companyName != '') {
            $.ajax({
                type: 'post',
                data: {"OpponentID":OpponentID,"applicationid":applicationid,"companyName": companyName,"address":address,"companyType":companyType,"businessScope":businessScope,
                        "salesScope":salesScope,"brand":brand,"staff":staff,"plan":plan,"introduce":introduce},
                url: "{:url('ProductBusiness/saveOpponent')}",
                dataType: 'json',
                success: function (data) {
                    if (data.code == 1) {
                        tankuang(300,data.msg);
                        $('#salesOpponentModal').modal("hide");
                        $("#OpponentID").val();
                        $("#companyName").val();
                        $("#address").val();
                        $("#companyType").val();
                        $("#businessScope").val();
                        $("#salesScope").val();
                        $("#brand").val();
                        $("#staff").val();
                        $("#plan").val();
                        $("#introduce").val();
                        location=location;
                    }
                }
            });
        }
        return false;
    }

    /*
    保存主要供应商
     */
    function saveSupplier(){
        var key='supplier';
        var SupplierID=$("#SupplierID").val();
        var applicationid=$("#applicationid").val();
        var supplierName = $.trim($("#supplierName").val());
        var supplierAddress=$.trim($("#supplierAddress").val());
        var linkPhone=$.trim($("#linkPhone").val());
        var linkman=$.trim($("#linkman").val());
        var interviewDate=$.trim($("#interviewDate").val());
        var start=$.trim($("#start").val());
        var mainProduct=$.trim($("#mainProduct").val());
        var limit=$.trim($("#limit").val());
        var payType=$.trim($("#payType").val());
        var term=$.trim($("#term").val());
        var evaluate=$.trim($("#evaluate").val());
        if (supplierName != '') {
            $.ajax({
                type: 'post',
                data: {"key":key,"SupplierID":SupplierID,"applicationid":applicationid,"supplierName": supplierName,
                    "supplierAddress":supplierAddress,"linkPhone":linkPhone,"linkman":linkman,
                    "interviewDate":interviewDate, "start":start,"mainProduct":mainProduct,"limit":limit,
                    "payType":payType,"term":term,"evaluate":evaluate
                },
                url: "{:url('BusinessSettle/saveSupplier')}",
                dataType: 'json',
                success: function (data) {
                    if (data.code == 1) {
                        tankuang(300,data.msg);
                        $('#supplierModal').modal("hide");
                        $("#SupplierID").val();
                        $("#supplierName").val();
                        $("#supplierAddress").val();
                        $("#linkPhone").val();
                        $("#linkman").val();
                        $("#interviewDate").val();
                        $("#start").val();
                        $("#mainProduct").val();
                        $("#limit").val();
                        $("#payType").val();
                        $("#term").val();
                        $("#evaluate").val();
                        location=location;
                    }
                }
            });
        }
        return false;
    }

    /*
     保存主要客户
     */
    function saveCustomer(){
        var key='customer';
        var SupplierID=$("#CustomerID").val();
        var applicationid=$("#applicationid").val();
        var supplierName = $.trim($("#customerName").val());
        var supplierAddress=$.trim($("#customerAddress").val());
        var linkPhone=$.trim($("#linkPhone1").val());
        var linkman=$.trim($("#linkman1").val());
        var interviewDate=$.trim($("#interviewDate1").val());
        var start=$.trim($("#start1").val());
        var mainProduct=$.trim($("#mainProduct1").val());
        var evaluate=$.trim($("#evaluate1").val());
        if (customerName != '') {
            $.ajax({
                type: 'post',
                data: {"key":key,"SupplierID":SupplierID,"applicationid":applicationid,"supplierName": supplierName,
                    "supplierAddress":supplierAddress,"linkPhone":linkPhone,"linkman":linkman,
                    "interviewDate":interviewDate, "start":start,"mainProduct":mainProduct,
                   "evaluate":evaluate
                },
                url: "{:url('BusinessSettle/saveSupplier')}",
                dataType: 'json',
                success: function (data) {
                    if (data.code == 1) {
                        tankuang(300,data.msg);
                        $('#customerModal').modal("hide");
                        $("#CustomerID").val();
                        $("#customerName").val();
                        $("#customerAddress").val();
                        $("#linkPhone1").val();
                        $("#linkman1").val();
                        $("#interviewDate1").val();
                        $("#start1").val();
                        $("#mainProduct1").val();
                        $("#evaluate1").val();
                        location=location;
                    }
                }
            });
        }
        return false;
    }

</script>
